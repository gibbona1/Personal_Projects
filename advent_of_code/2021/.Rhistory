getwd()
myfile <- readLines("input_day07.txt")
myfile
strsplit(myfile, ",")[[1]]
as.integer(strsplit(myfile, ",")[[1]])
as.integer(strsplit('16,1,2,0,4,2,7,1,2,14', ',')[[1]])
tmp_pos <- as.integer(strsplit('16,1,2,0,4,2,7,1,2,14', ',')[[1]])
mean(tmp_pos)
for(i in 1:16){
print(mean(abs(tmp_pos-i)))
}
range(tmp_pos)
pos_range <- range(tmp_pos)
pos_nums <- pos_range[1]:pos_range[2]
pos_nums
for(i in pos_nums){
costs <- c(costs, mean(abs(tmp_pos-i)))
}
costs <- c()
for(i in pos_nums){
costs <- c(costs, mean(abs(tmp_pos-i)))
}
which.min(costs)-1
min(costs)
get_min_cost <- function(vec){
pos_range <- range(vec)
pos_nums  <- pos_range[1]:pos_range[2]
pos_nums
costs <- c()
for(i in pos_nums){
costs <- c(costs, mean(abs(vec-i)))
}
#which.min(costs)-1
return(min(costs))
}
my_pos <- as.integer(strsplit(myfile, ",")[[1]])
get_min_cost(my_pos)
get_min_cost <- function(vec){
pos_range <- range(vec)
pos_nums  <- pos_range[1]:pos_range[2]
pos_nums
costs <- c()
for(i in pos_nums){
costs <- c(costs, sum(abs(vec-i)))
}
#which.min(costs)-1
return(min(costs))
}
get_min_cost(my_pos)
get_min_cost2 <- function(vec){
pos_range <- range(vec)
pos_nums  <- pos_range[1]:pos_range[2]
incr_dist <- function(x) return(x*(x+1)/2)
costs <- c()
for(i in pos_nums){
costs <- c(costs, sum(incr_dist(abs(vec-i))))
}
#which.min(costs)-1
return(min(costs))
}
get_min_cost(tmp_pos)
incr_dist(4)
incr_dist <- function(x) return(x*(x+1)/2)
incr_dist(4)
get_min_cost(tmp_pos)
get_min_cost3(tmp_pos)
get_min_cost2(tmp_pos)
get_min_cost2(my_pos)
get_min_cost(tmp_pos)
get_min_cost(my_pos)
get_min_cost <- function(vec){
pos_range <- range(vec)
pos_nums  <- pos_range[1]:pos_range[2]
pos_nums
costs <- sapply(pos_nums, function(x) sum(abs(vec-x)))
#for(i in pos_nums)
#  costs <- c(costs, sum(abs(vec-i)))
#which.min(costs)-1
return(min(costs))
}
get_min_cost(tmp_pos)
get_min_cost(my_pos)
